__text in markdown with latex__

## üå≤ –î–µ—Ä–µ–≤–æ –≤—ñ–¥—Ä—ñ–∑–∫—ñ–≤

–ù–µ—Ö–∞–π –∑–∞–¥–∞–Ω–æ –¥–µ—è–∫–∏–π —ñ–Ω–¥–µ–∫—Å–æ–≤–∞–Ω–∏–π –º–∞—Å–∏–≤ –¥–∞–Ω–∏—Ö  
$$
a = \{a_i : i \in [0, n]\}.
$$

### üìå –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è

**–î–µ—Ä–µ–≤–æ –≤—ñ–¥—Ä—ñ–∑–∫—ñ–≤** ‚Äì —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑–∞ —á–∞—Å  
$$
O(\log n)
$$  
–∑–Ω–∞—Ö–æ–¥–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–µ—è–∫–æ—ó —Ü—ñ–ª—å–æ–≤–æ—ó –∞—Å–æ—Ü—ñ–∞—Ç–∏–≤–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –º–∞—Å–∏–≤—É $a$ –Ω–∞ –ø—Ä–æ–º—ñ–∂–∫—É $[i, j]$,  
$$
0 \le i \le j \le n,
$$  
—Ç–æ–±—Ç–æ:
$$
f(a_i, a_{i+1}, \dots, a_j).
$$

üìé **–ü—Ä–∏–∫–ª–∞–¥–∏ —Ü—ñ–ª—å–æ–≤–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π**:
- –°—É–º–∞
- –î–æ–±—É—Ç–æ–∫
- –ú—ñ–Ω—ñ–º—É–º / –º–∞–∫—Å–∏–º—É–º
- –ù–∞–π–±—ñ–ª—å—à–∏–π —Å–ø—ñ–ª—å–Ω–∏–π –¥—ñ–ª—å–Ω–∏–∫ (–ù–°–î)
- –Ü–Ω—à—ñ –∞—Å–æ—Ü—ñ–∞—Ç–∏–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

---

### üå≥ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ—Ä–µ–≤–∞

- –î–µ—Ä–µ–≤–æ –≤—ñ–¥—Ä—ñ–∑–∫—ñ–≤ ‚Äî —Ü–µ **–ø–æ–≤–Ω–µ –±—ñ–Ω–∞—Ä–Ω–µ –¥–µ—Ä–µ–≤–æ**, –¥–µ –∫–æ–∂–Ω–∞ –≤–µ—Ä—à–∏–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –ø–µ–≤–Ω–æ–º—É –≤—ñ–¥—Ä—ñ–∑–∫—É –º–∞—Å–∏–≤—É.
- **–ö–æ—Ä—ñ–Ω—å –¥–µ—Ä–µ–≤–∞** –æ—Ö–æ–ø–ª—é—î –≤–µ—Å—å –º–∞—Å–∏–≤.
- –ö–æ–∂–µ–Ω –≤—É–∑–æ–ª, —â–æ –æ—Ö–æ–ø–ª—é—î –±—ñ–ª—å—à–µ –Ω—ñ–∂ –æ–¥–∏–Ω –µ–ª–µ–º–µ–Ω—Ç, –º–∞—î **–¥–≤–æ—Ö —Å–∏–Ω—ñ–≤**, —è–∫—ñ –æ—Ö–æ–ø–ª—é—é—Ç—å –ª—ñ–≤—É —Ç–∞ –ø—Ä–∞–≤—É –ø–æ–ª–æ–≤–∏–Ω—É –π–æ–≥–æ –¥—ñ–∞–ø–∞–∑–æ–Ω—É.
- **–õ–∏—Å—Ç–∫–∏ –¥–µ—Ä–µ–≤–∞** –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –æ–∫—Ä–µ–º–∏–º –µ–ª–µ–º–µ–Ω—Ç–∞–º –º–∞—Å–∏–≤—É.

---

### ‚ö° –ü–æ–±—É–¥–æ–≤–∞ –¥–µ—Ä–µ–≤–∞ –¥–ª—è —Å—É–º–∏

–î–ª—è –º–∞—Å–∏–≤—É –∑ $k$ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –¥–µ—Ä–µ–≤–æ –≤—ñ–¥—Ä—ñ–∑–∫—ñ–≤ –º—ñ—Å—Ç–∏—Ç–∏–º–µ $2n$ –≤–µ—Ä—à–∏–Ω, –¥–µ  
$$
n = 2^p \text{ ‚Äî –Ω–∞–π–º–µ–Ω—à–∏–π —Å—Ç–µ–ø—ñ–Ω—å –¥–≤—ñ–π–∫–∏, —Ç–∞–∫–∏–π —â–æ } k \le n.
$$

–í–∏—Å–æ—Ç–∞ –¥–µ—Ä–µ–≤–∞:
$$
\log n.
$$

---

### üîç –ì–æ–ª–æ–≤–Ω–∞ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å

–ö–æ–∂–µ–Ω **–Ω–µ–ø–µ—Ä–µ—Ä–≤–Ω–∏–π –≤—ñ–¥—Ä—ñ–∑–æ–∫** –º–∞—Å–∏–≤—É –∑ $p$ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –º–æ–∂–Ω–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –Ω–µ –±—ñ–ª—å—à –Ω—ñ–∂  
$$
2 \log p
$$  
–≤–µ—Ä—à–∏–Ω –¥–µ—Ä–µ–≤–∞.

üìå –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –¥–ª—è –≤—ñ–¥—Ä—ñ–∑–∫—É $[1, 6]$ –º–∞—Å–∏–≤—É:
```
–Ü–Ω–¥–µ–∫—Å:   0  1  2  3  4  5  6  7  
–ú–∞—Å–∏–≤:    2  7  6  4  1  3  5  8
```
–î–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Å—É–º–∏ –Ω–∞ —Ü—å–æ–º—É –≤—ñ–¥—Ä—ñ–∑–∫—É –±—É–¥–µ –¥–æ—Å—Ç–∞—Ç–Ω—å–æ **4-—Ö –≤—É–∑–ª—ñ–≤** –¥–µ—Ä–µ–≤–∞.

---

### üíæ –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –≤ –ø–∞–º‚Äô—è—Ç—ñ –∫–æ–º–ø‚Äô—é—Ç–µ—Ä–∞

- –î–µ—Ä–µ–≤–æ —î **–ø–æ–≤–Ω–∏–º –±—ñ–Ω–∞—Ä–Ω–∏–º**, —Ç–æ–º—É —è–∫ —ñ **–±—ñ–Ω–∞—Ä–Ω–∞ –∫—É–ø–∞**, –º–æ–∂–µ –±—É—Ç–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–µ –∑–≤–∏—á–∞–π–Ω–∏–º –º–∞—Å–∏–≤–æ–º —Ä–æ–∑–º—ñ—Ä–æ–º $2n$.
- –õ–∏—Å—Ç–∫–∏ (–µ–ª–µ–º–µ–Ω—Ç–∏ –≤—Ö—ñ–¥–Ω–æ–≥–æ –º–∞—Å–∏–≤—É) –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É **–¥—Ä—É–≥—ñ–π –ø–æ–ª–æ–≤–∏–Ω—ñ –º–∞—Å–∏–≤—É**:
  - $a_0$ ‚Äî –Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó $n$
  - $a_1$ ‚Äî –Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó $n+1$
  - ...
- –í–Ω—É—Ç—Ä—ñ—à–Ω—ñ –≤—É–∑–ª–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –Ω–∞ –ø–æ–∑–∏—Ü—ñ—è—Ö $2$ –¥–æ $n-1$
- –ö–æ—Ä—ñ–Ω—å ‚Äî —É –ø–æ–∑–∏—Ü—ñ—ó $1$
- **–ü–æ–∑–∏—Ü—ñ—è $0$** ‚Äî –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è

---

### üõ†Ô∏è –û–ø–µ—Ä–∞—Ü—ñ—ó –∑ –¥–µ—Ä–µ–≤–æ–º –≤—ñ–¥—Ä—ñ–∑–∫—ñ–≤

1. **–ü–æ–±—É–¥–æ–≤–∞** –¥–µ—Ä–µ–≤–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –≤—Ö—ñ–¥–Ω–æ–≥–æ –º–∞—Å–∏–≤—É
2. **–û–Ω–æ–≤–ª–µ–Ω–Ω—è** –∑–Ω–∞—á–µ–Ω–Ω—è –æ–¥–Ω–æ–≥–æ –∑ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
3. **–ó–∞–ø–∏—Ç** –Ω–∞ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ü—ñ–ª—å–æ–≤–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó –Ω–∞ –∑–∞–¥–∞–Ω–æ–º—É –≤—ñ–¥—Ä—ñ–∑–∫—É



# Implementation

## C++
```c++
#include <vector>  
  
using std::vector;  
  
static const int NEUTRAL_ELEMENT = 0;  
  
class DecisionTree{  
private:  
    vector<int> items;  
    size_t _size;  
  
    void fill_tree(){  
        for (size_t i = _size - 1; i > 0; i--)  
                                    // any binary operation can be used  
            items[i] = items[2*i + 1] + items[2*i+ 2];  
    }  
public:  
    explicit DecisionTree(const vector<int>& vec){  
  
        size_t n = vec.size();  
        size_t m = 1;  
  
        while(m < n)  
            m <<= 1;  
  
        _size = m;  
        items.resize(_size, NEUTRAL_ELEMENT);  
  
        for (size_t i = 0; i < n; i++){  
            items[i+_size] = vec[i];  
        }  
        fill_tree();  
    }  
  
    void update(size_t position, int value){  
  
  
        position += _size;  
        items[position] = value;  
  
        while (position > 1){  
            position /= 2;  
  
            items[position] = items[2*position + 1] + items[2*position + 2];  
        }    }  
    int get_binary_op(size_t left, size_t right)  {  
  
        int result = NEUTRAL_ELEMENT;  
  
        left += _size;  
        right += _size;  
        while (left <= right){  
            if (left % 2 == 1) result += items[left];  
            if (right % 2 == 0) result += items[right];  
  
            left = (left + 1) / 2;  
            right = (right - 1) / 2;  
        }  
        return result;  
    }  
};


```


## Python

``` python
from math import log2

class SegmentTree:
    def __init__(self, array):
        """
        –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
        :param array: –í—Ö—ñ–¥–Ω–∏–π –º–∞—Å–∏–≤ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
        """
        k = len(array)                           # –∫—ñ–ª—å–∫—ñ—Å—Ç—å –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —É –º–∞—Å–∏–≤—ñ –¥–∞–Ω–∏—Ö
        n = (1 << int(log2(k - 1)) + 1)          # –¥–æ–≤–æ–¥–∏–º–æ —Ä–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å –º–∞—Å–∏–≤—É –¥–æ —Å—Ç–µ–ø–µ–Ω—ñ 2
        self.mItems = 2 * n * [0]                # –º–∞—Å–∏–≤ –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤—É–∑–ª—ñ–≤ –¥–µ—Ä–µ–≤–∞

        # –∑–∞–ø–∏—Å—É—î–º–æ –¥–∞–Ω—ñ –≤—Ö—ñ–¥–Ω–æ–≥–æ –º–∞—Å–∏–≤—É —É –ª–∏—Å—Ç–∫–∏ –¥–µ—Ä–µ–≤–∞
        for i in range(k):
            self.mItems[n + i] = array[i]

        # –∑–∞–ø–∏—Å—É—î–º–æ –¥–∞–Ω—ñ –¥–ª—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö –≤—É–∑–ª—ñ–≤ –¥–µ—Ä–µ–≤–∞
        for i in range(n - 1, 0, -1):
            self.mItems[i] = self.mItems[2 * i] + self.mItems[2 * i + 1]

        self.mSize = n                           # –∑–∞–ø–∞–º‚Äô—è—Ç–æ–≤—É—î–º–æ —Ä–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å –º–∞—Å–∏–≤—É

    def update(self, pos, x):
        """
        –ó–∞–º—ñ–Ω–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è –∫–ª—é—á–∞ —É –≤—Ö—ñ–¥–Ω–æ–º—É –º–∞—Å–∏–≤—ñ
        :param pos: –ø–æ–∑–∏—Ü—ñ—è –µ–ª–µ–º–µ–Ω—Ç–∞ –≤—Ö—ñ–¥–Ω–æ–≥–æ –º–∞—Å–∏–≤—É, —â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–º—ñ–Ω–∏—Ç–∏
        :param x: –Ω–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è
        """
        pos += self.mSize
        self.mItems[pos] = x                     # –ó–º—ñ–Ω—é—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è —É –ª–∏—Å—Ç—ñ

        # –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è —É –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ—Ö –≤—É–∑–ª–∞—Ö
        i = pos // 2                             # –ü–æ–∑–∏—Ü—ñ—è –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–æ–≥–æ –≤—É–∑–ª–∞
        while i > 0:
            self.mItems[i] = self.mItems[2 * i] + self.mItems[2 * i + 1]
            i //= 2

    def sum(self, left, right):
        """
        –°—É–º–∞ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –≤—ñ–¥—Ä—ñ–∑–∫—É –≤—ñ–¥ left –¥–æ right –≤—Ö—ñ–¥–Ω–æ–≥–æ –º–∞—Å–∏–≤—É
        :param left: –ª—ñ–≤–∞ –º–µ–∂–∞ –≤—ñ–¥—Ä—ñ–∑–∫—É
        :param right: –ø—Ä–∞–≤–∞ –º–µ–∂–∞ –≤—ñ–¥—Ä—ñ–∑–∫—É
        """
        left += self.mSize
        right += self.mSize

        res = 0
        while left <= right:
            if left % 2 == 1:                    # —è–∫—â–æ left - –ø—Ä–∞–≤–∏–π —Å–∏–Ω —Å–≤–æ–≥–æ –±–∞—Ç—å–∫–∞
                res += self.mItems[left]
            if right % 2 == 0:                   # —è–∫—â–æ right - –ª—ñ–≤–∏–π —Å–∏–Ω —Å–≤–æ–≥–æ –±–∞—Ç—å–∫–∞
                res += self.mItems[right]

            # –ø—ñ–¥—ñ–π–º–∞—î–º–æ—Å—è —É –¥–µ—Ä–µ–≤—ñ –Ω–∞ —Ä—ñ–≤–µ–Ω—å –≤–∏—â–µ
            left = (left + 1) // 2
            right = (right - 1) // 2

        return res

```